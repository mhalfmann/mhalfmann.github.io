<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<link rel="stylesheet" href="TemplateData/style.css">
    <script src="TemplateData/UnityProgress.js"></script>
    <script src="Build/UnityLoader.js"></script>    
</head>
<body onload="iwmstudy_access.addInitFunction(init)">
	<script src="../../../../app/iwm_studyaddon.js"></script>
	<div id="iwmstudy_masterbox"><div id="iwmstudy_centerbox">	
		
		<!-- Inhalt -->
		<div id="iwmstudy_contentbox">
			<div class="webgl-content" style="width: 90%; height: 100%;">
				<div id="gameContainer" style="width: 100%; height: 100%;"></div>				
			</div>
		</div>

	</div></div>
	<script>
		var unityInstance
		
		function init(){
			unityInstance = UnityLoader.instantiate("gameContainer", "Build/Fische.json", {onProgress: UnityProgress})
		}

		function OnAppReady(){			
			console.log("vr application has been loaded")
			unityInstance.SendMessage('control', 'setName', iwmstudy_access.getStudyinfo().user)			
			let condid = iwmstudy_access.getStudyinfo().conditionid
			//0 = Fisch bewegen, 1 = Kamera bewegen, 2 = keine Interaktion			
			let mode = 0
			if(condid == "camcontr"){
				mode = 1
			}
			else if(condid == "nointerac"){
				mode = 2
			}
			unityInstance.SendMessage('control', 'setMode', mode)
		}

		function OnAppRunning(){
			console.log("scene has been loaded")
			iwmstudy_access.logAction("vrsceneloaded",{})			  
    	}

		function OnAppEnd(){
			console.log("vr application has finished")
			iwmstudy_access.enableNextButton()
			iwmstudy_access.linkto()
		}
	</script>
</body>